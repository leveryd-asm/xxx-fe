<template>
  <cute_table :url="url" :create_flag=false :module_name="module_name" :columns="columns">
    <template slot-scope="scope" slot="custom_template">
      <el-input type="textarea" v-model="scope.row.header" :autosize="{maxRows:10,minRows:10}" v-if="scope.col['name']==='header'"> </el-input>
      <el-input type="textarea" v-model="scope.row.content" :autosize="{maxRows:10,minRows:10}" v-if="scope.col['name']==='content'"> </el-input>
    </template>
  </cute_table>
</template>
<script>
/* eslint-disable */
import cute_table from '@/components/Table/table.vue'

export default {
  name: 'app',
  components: {
    cute_table
  },
  data: function () {
    return {
      filter: {
        limit: 10, // 页大小
        offset: 1, // 当前页
        asc: 0 //默认降序
      },
      url: process.env.SOC_API,
      module_name: 'vuln',
      columns: [
        {
          'name': 'url',
          'label': 'url',
        },
        {
          'name': 'position',
          'label': 'position',
          'width': 100,
          'sortable': false,
        },
        {
          'name': 'param',
          'label': 'param',
          'width': 100,
          'sortable': false,
        },
        {
          'name': 'plugin',
          'label': 'plugin',
          'width': 100,
          'sortable': false,
        },
        {
          'name': 'project',
          'label': 'project',
          'width': 100,
          'sortable': false,
        },
        {
          'name': 'timestamp',
          'label': 'time',
          'width': 200,
          'sortable': false,
        },
        {
          'name': 'request',
          'label': 'request',
          "width": 500,
          'render': function (row){
            let request=row.request;
            let reqstr=JSON.parse(request).snapshot[0][0];
            let resstr=JSON.parse(request).snapshot[0][1];
            reqstr=reqstr.replaceAll("<","&lt;");
            reqstr=reqstr.replaceAll(">","&gt;");
            return `<textarea>${reqstr}</textarea>`;
          },
        },
        {
          'name': 'response',
          'label': 'response',
          "width": 500,
          'render': function (row){
            let request=row.request;
            let reqstr=JSON.parse(request).snapshot[0][0];
            let resstr=JSON.parse(request).snapshot[0][1];
            resstr=resstr.replaceAll("<","&lt;");
            resstr=resstr.replaceAll(">","&gt;");
            return `<textarea>${resstr}</textarea>`;
          },
        },
        {
          'name': 'query',
          'label': 'query',
          'search': true,
          'val': 'scope:in',
        },
      ],
    }
  },
}
</script>

<style>
textarea{
  min-width: 500px;
  max-width: 1000px;
  min-height: 500px;
  max-height: 600px
}
</style>
